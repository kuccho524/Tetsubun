<!-- ユーザー情報編集フォーム -->
<%= form_with model: user, url: user_path, local:true do |f| %>
   <%= render 'layouts/errors', obj: user %>
   <div class="form-group">
     <%= f.label :プロフィール画像, class: "font-weight-bold" %>
     <%= f.file_field :profile_image, class: "form-control-file user_image" %>
   </div>
   <% if user.profile_image.present? %>
     <%= image_tag user.profile_image, id: "preview" %>
   <% else %>
     <%= image_tag asset_path "no_image.jpg", id: "preview" %>
   <% end %>
   <div class="form-group">
     <%= f.label :ユーザ名, class: "font-weight-bold" %>
     <%= f.text_field :name, class: "form-control name" %>
   </div>
   <div class="form-group">
     <%= f.label :紹介文, class: "font-weight-bold" %>
     <%= f.text_area :introduction, class: "form-control introduction", size: '90x8' %>
   </div>
   <div class="form-group">
     <%= f.submit '更新する', class: 'btn btn-success' %>
   </div>
<% end %>

<script>
   $('#user_profile_image').on('change', function (e) {
     var reader = new FileReader();
     reader.onload = function (e) {
       $("#preview").attr('src', e.target.result);
     }
     reader.readAsDataURL(e.target.files[0]);
   });
</script>